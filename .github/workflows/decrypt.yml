name: OZIP Decrypter

on:
  push:
    branches: [ main ]
  schedule:
    - cron: '0 0 * * *'

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: Download OZIP
      run: |
        sudo apt-get update
        sudo apt-get install -y aria2
        aria2c https://assorted.downloads.oppo.com/firmware/CPH1853/CPH1853EX_11_OTA_0390_all_qQmLjfJVO5eN.ozip
    - name: Decrypt OZIP
      run: |
        sudo apt-get update
        sudo apt-get install -y python3-pip zip
        sudo pip3 install setuptools wheel docopt pycryptodome
        wget https://raw.githubusercontent.com/techyminati/oppo_ozip_decrypt/master/ozipdecrypt.py
        python3 ozipdecrypt.py CPH1853EX_11_OTA_0390_all_qQmLjfJVO5eN.ozip
    - name: Upload Decrypted ZIP
      run: curl -T CPH1853EX_11_OTA_0390_all_qQmLjfJVO5eN.zip https://bashupload.com/
